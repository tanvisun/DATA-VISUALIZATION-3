<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Country Comparison Dashboard: US vs India</title>
    <link rel="stylesheet" href="libs/bootstrap/bootstrap.min.css">
    <script src="libs/d3/d3.v7.min.js"></script>
    <style>
        body{background-color: #fdf5e2; /* Light gray background */
        font-family: Arial, sans-serif; /* Optional: Change the font */
    }/* ChatGPT Link at the top right */
    #chatgpt-link {
            position: absolute;
            bottom: 50px;
            right: 20px;
            background-color: #007bff;
            margin-top: 300;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            text-decoration: none;
        }

        #chatgpt-link:hover {
            background-color: #0056b3;
        }

        

        svg {
            font-family: Arial, sans-serif;
        }

        .bar {
            transition: all 0.3s ease;
        }

        .bar:hover {
            opacity: 0.7;
        }

        .legend rect {
            stroke-width: 1px;
        }

        .legend text {
            font-size: 12px;
        }

        .chart-container {
            margin-bottom: 30px;
            height: 100%;
        }

        .year_dropdown {
            width: 200px;
        }

        .chart-container svg {
            width: 100%;
        }

        .container-fluid {
            height: 100vh;
        }

        .quadrant {
            border: 1px solid #ddd;
            padding: 10px;
        }
        #chatgpt-usage-note {
            text-align: bottom;
            margin-top: 300px;
            font-size: 14px;
            color: #333;
            background-color: 		#fdf1cb;
            padding: 20px 0;
            position: relative;
        }

        #chatgpt-usage-note a {
            color: #007bff;
            text-decoration: none;
        }

        #chatgpt-usage-note a:hover {
            text-decoration: underline;
        }

        
    </style>
</head>
<body>
    
    <div class="container-fluid">
        <h2 class="text-center mt-4 mb-4">Country Comparison: United States vs India (2015-2021)</h2>
        <div class="row" style="height: 80vh;">
            <div class="col-md-6 quadrant">
                <div class="chart-container">
                    <h4 class="text-center">Adjusted Net National Income (Annual % Growth) (Bar Chart)</h4>
                    <div id="chart-container-1"></div>
                </div>
            </div>
            <div class="col-md-6 quadrant">
                <div class="chart-container">
                    <h4 class="text-center">GDP Growth (Line Chart)</h4>
                    <div id="chart-container-2"></div>
                </div>
            </div>
            <div class="col-md-6 quadrant">
                <div class="chart-container">
                    <h4 class="text-center">Population Distribution (Pie Chart)</h4>
                    <div id="chart-container-3"></div>
                </div>
            </div>
            <div class="col-md-6 quadrant">
                <div class="chart-container">
                    <h4 class="text-center">Gross Savings (% of GDP) (Clustered Horizontal Bar Chart)</h4>
                    <div id="chart-container-4"></div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let incomeGrowthData, gdpData, savingsData;


        // Load the CSV file and process the data
        d3.csv("data/twocountries.csv").then(function(data) {
            const filteredIncomeGrowthData = data.filter(d => 
                d['Series Name'] === "Adjusted net national income (annual % growth)" && 
                (d['Country Name'] === "United States" || d['Country Name'] === "India")
            );

            const filteredGDPData = data.filter(d => 
                d['Series Name'] === "GDP growth (annual %)" && 
                (d['Country Name'] === "United States" || d['Country Name'] === "India")
            );

            incomeGrowthData = [];
            filteredIncomeGrowthData.forEach(d => {
                for (let year = 2015; year <= 2021; year++) {
                    incomeGrowthData.push({
                        country: d['Country Name'],
                        year: year,
                        growth: +d[`${year} [YR${year}]`]
                    });
                }
            });

            gdpData = [];
            filteredGDPData.forEach(d => {
                for (let year = 2015; year <= 2021; year++) {
                    gdpData.push({
                        country: d['Country Name'],
                        year: year,
                        gdpGrowth: +d[`${year} [YR${year}]`]
                    });
                }
            });

            const filteredSavingsData = data.filter(d => 
                d['Series Name'] === "Gross savings (% of GDP)" && 
                (d['Country Name'] === "United States" || d['Country Name'] === "India")
            );

            savingsData = [];
            filteredSavingsData.forEach(d => {
                for (let year = 2015; year <= 2021; year++) {
                    savingsData.push({
                        country: d['Country Name'],
                        year: year,
                        savings: +d[`${year} [YR${year}]`]
                    });
                }
            });

            console.log("Income Growth Data:", incomeGrowthData);
            console.log("GDP Data:", gdpData);

            createBarChart(incomeGrowthData, "#chart-container-1");
            createLineChart(gdpData, "#chart-container-2");
            createPieChart("#chart-container-3");
            createHorizontalBarChart(savingsData, "#chart-container-4");
        });
        function createHorizontalBarChart(data, containerId) {
    const margin = { top: 20, right: 30, bottom: 40, left: 100 };
    const width = 600 - margin.left - margin.right;
    const height = 400 - margin.top - margin.bottom;

    const svg = d3.select(containerId).append("svg")
        .attr("id", "clustered-horiz-bar-chart")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", `translate(${margin.left}, ${margin.top})`);

    // Extract unique years
    const years = [...new Set(data.map(d => d.year))];

    // Define scales
    const y = d3.scaleBand()
        .domain(years)
        .range([0, height])
        .padding(0.2); // Space between bars

    const x = d3.scaleLinear()
        .domain([0, d3.max(data, d => d.savings)])
        .nice()
        .range([0, width]);

    const color = d3.scaleOrdinal()
        .domain(["United States", "India"])
        .range(["blue", "pink"]);

    const xSubgroup = d3.scaleBand()
        .domain(["United States", "India"])
        .range([0, y.bandwidth()])
        .padding(0.1);

    // Add axes
    svg.append("g").call(d3.axisLeft(y));
    svg.append("g")
        .attr("transform", `translate(0, ${height})`)
        .call(d3.axisBottom(x).ticks(5));

    // Tooltip
    const tooltip = d3.select(containerId).append("div")
        .style("position", "absolute")
        .style("visibility", "hidden")
        .style("background", "rgba(0, 0, 0, 0.7)")
        .style("color", "#fff")
        .style("padding", "5px 10px")
        .style("border-radius", "5px")
        .style("font-size", "12px");

    // Create grouped bars
    const bars = svg.selectAll(".year-group")
        .data(years)
        .enter().append("g")
        .attr("class", "year-group")
        .attr("transform", d => `translate(0, ${y(d)})`);

    bars.selectAll("rect")
        .data(d => data.filter(item => item.year === d))
        .enter().append("rect")
        .attr("class", "bar")
        .attr("y", d => xSubgroup(d.country))
        .attr("x", 0) // Start position for animation
        .attr("width", 0) // Start with zero width
        .attr("height", xSubgroup.bandwidth())
        .attr("fill", d => color(d.country))
        .on("mouseover", (event, d) => {
            tooltip.style("visibility", "visible")
                .text(`${d.country} (${d.year}): ${d.savings.toFixed(2)}%`)
                .style("left", (event.pageX + 10) + "px")
                .style("top", (event.pageY - 30) + "px");
        })
        .on("mousemove", (event) => {
            tooltip.style("left", (event.pageX + 10) + "px")
                .style("top", (event.pageY - 30) + "px");
        })
        .on("mouseout", () => tooltip.style("visibility", "hidden"))
        .transition() // Animation
        .duration(1000)
        .attr("width", d => x(d.savings));

    // Add legend
    const legend = svg.append("g")
        .attr("transform", `translate(${width - 150}, -20)`);

    ["United States", "India"].forEach((country, i) => {
        legend.append("rect")
            .attr("x", 0)
            .attr("y", i * 20)
            .attr("width", 18)
            .attr("height", 18)
            .attr("fill", color(country));

        legend.append("text")
            .attr("x", 25)
            .attr("y", i * 20 + 13)
            .text(country);
    });
}
        function createBarChart(data, containerId) {
            const margin = { top: 20, right: 30, bottom: 40, left: 70 };
            const width = 600 - margin.left - margin.right;
            const height = 400 - margin.top - margin.bottom;

            const svg = d3.select(containerId).append("svg")
                .attr("id", "barchart")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left}, ${margin.top})`);

            const x0 = d3.scaleBand()
                .domain([2015, 2016, 2017, 2018, 2019, 2020, 2021])
                .range([0, width])
                .padding(0.1);

            const x1 = d3.scaleBand()
                .domain(["United States", "India"])
                .rangeRound([0, x0.bandwidth()])
                .padding(0.05);

            const y = d3.scaleLinear()
                .domain([d3.min(data, d => d.growth), d3.max(data, d => d.growth)])
                .nice()
                .range([height, 0]);

            svg.append("g")
                .attr("transform", `translate(0, ${height})`)
                .call(d3.axisBottom(x0));

            svg.append("g")
                .call(d3.axisLeft(y).tickFormat(d => d.toFixed(2) + "%"));

            const tooltip = d3.select(containerId).append("div")
                .style("position", "absolute")
                .style("visibility", "hidden")
                .style("background", "rgba(0, 0, 0, 0.7)")
                .style("color", "#fff")
                .style("padding", "5px 10px")
                .style("border-radius", "5px")
                .style("font-size", "12px");

            svg.selectAll(".bar")
                .data(data)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", d => x0(d.year) + x1(d.country))
                .attr("y", height)
                .attr("width", x1.bandwidth())
                .attr("height", 0)
                .attr("fill", d => d.country === "United States" ? "blue" : "pink")
                .on("mouseover", (event, d) => {
                    tooltip.style("visibility", "visible")
                        .text(`${d.country}: ${d.growth.toFixed(2)}%`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 30) + "px");
                })
                .on("mousemove", (event) => {
                    tooltip.style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 30) + "px");
                })
                .on("mouseout", () => tooltip.style("visibility", "hidden"))
                .transition()
                .duration(1000)
                .attr("y", d => y(d.growth))
                .attr("height", d => height - y(d.growth));

            const legend = svg.append("g")
                .attr("class", "legend")
                .attr("transform", `translate(${width - 100}, 0)`);

            legend.append("rect")
                .attr("width", 18)
                .attr("height", 18)
                .attr("fill", "blue");

            legend.append("text")
                .attr("x", 25)
                .attr("y", 9)
                .attr("dy", ".35em")
                .text("United States");

            legend.append("rect")
                .attr("y", 20)
                .attr("width", 18)
                .attr("height", 18)
                .attr("fill", "pink");

            legend.append("text")
                .attr("x", 25)
                .attr("y", 29)
                .attr("dy", ".35em")
                .text("India");
        }

        function createLineChart(data, containerId) {
            const margin = { top: 20, right: 30, bottom: 40, left: 40 };
            const width = 600 - margin.left - margin.right;
            const height = 400 - margin.top - margin.bottom;

            const svg = d3.select(containerId).append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

            const x = d3.scaleBand()
                .domain([2015, 2016, 2017, 2018, 2019, 2020, 2021])
                .range([0, width])
                .padding(0.1);

            const y = d3.scaleLinear()
                .domain([d3.min(data, d => d.gdpGrowth), d3.max(data, d => d.gdpGrowth)])
                .nice()
                .range([height, 0]);

            const line = d3.line()
                .x(d => x(d.year))
                .y(d => y(d.gdpGrowth));

            const countryData = ["United States", "India"];

            const tooltip = d3.select(containerId).append("div")
                .attr("class", "tooltip")
                .style("position", "absolute")
                .style("visibility", "hidden")
                .style("background-color", "rgba(0,0,0,0.6)")
                .style("color", "#fff")
                .style("padding", "5px")
                .style("border-radius", "3px");

            const dropdown = d3.select(containerId)
                .append("div")
                .style("text-align", "center")
                .style("margin-bottom", "10px")
                .append("select")
                .attr("class", "dropdown form-select w-50 mx-auto")
                .on("change", function() {
                    const selectedCountry = this.value;
                    updateChart(selectedCountry);
                });

            dropdown.selectAll("option")
                .data(countryData)
                .enter().append("option")
                .attr("value", d => d)
                .text(d => d);

            function updateChart(selectedCountry) {
                svg.selectAll(".line").remove();
                svg.selectAll(".dot").remove();

                const countryGDPData = data.filter(d => d.country === selectedCountry);

                svg.append("path")
                    .data([countryGDPData])
                    .attr("class", "line")
                    .attr("d", line)
                    .attr("fill", "none")
                    .attr("stroke", selectedCountry === "United States" ? "blue" : "pink")
                    .attr("stroke-width", 2)
                    .attr("stroke-dasharray", function() {
                        const length = this.getTotalLength();
                        return `${length} ${length}`;
                    })
                    .attr("stroke-dashoffset", function() {
                        return this.getTotalLength();
                    })
                    .transition()
                    .duration(2000)
                    .attr("stroke-dashoffset", 0);

                svg.selectAll(".dot")
                    .data(countryGDPData)
                    .enter().append("circle")
                    .attr("class", "dot")
                    .attr("cx", d => x(d.year))
                    .attr("cy", height)
                    .attr("r", 5)
                    .attr("fill", selectedCountry === "United States" ? "blue" : "pink")
                    .transition()
                    .duration(1000)
                    .attr("cy", d => y(d.gdpGrowth));
            }

            svg.append("g")
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(x).tickValues([2015, 2016, 2017, 2018, 2019, 2020, 2021]));

            svg.append("g")
                .call(d3.axisLeft(y));

            updateChart("United States");
        }

        function createPieChart(containerId) {
                d3.select(containerId).select("div.dropdown").remove();
            const dropdownContainer = d3.select(containerId)
                .append("div")
                .style("text-align", "center")
                .style("margin-bottom", "10px");

            dropdownContainer.append("label")
                .text("Select Year: ")
                .style("font-weight", "bold")
                .style("margin-right", "5px");

            const dropdown = dropdownContainer.append("select")
                .attr("class", "dropdown form-select w-50 mx-auto")
                .on("change", function () {
                    updatePieChart(+this.value);
                });

            d3.csv("data/twocountries.csv").then(function (data) {
                const filteredData = data.filter(d =>
                    d['Series Name'] === "Population, total" &&
                    (d['Country Name'] === "United States" || d['Country Name'] === "India")
                );

                const years = Object.keys(filteredData[0])
                    .filter(key => key.includes("[YR"))
                    .map(key => key.match(/\d{4}/)[0]);

                dropdown.selectAll("option")
                    .data(years)
                    .enter().append("option")
                    .attr("value", d => d)
                    .text(d => d);

                const latestYear = years[years.length - 1];
                dropdown.property("value", latestYear);

                updatePieChart(latestYear);
            });

            function updatePieChart(year) {
    d3.csv("data/twocountries.csv").then(function (data) {
        // Filter the data for the selected year and countries (United States and India)
        const filteredData = data.filter(d =>
            d['Series Name'] === "Population, total" &&
            (d['Country Name'] === "United States" || d['Country Name'] === "India")
        );

        // Extract population data for the selected year
        const populationData = filteredData.map(d => ({
            country: d["Country Name"],
            population: +d[`${year} [YR${year}]`]
        }));

        // Remove the previous svg element
        d3.select(`${containerId} svg`).remove();

        const width = 400, height = 400, radius = Math.min(width, height) / 2;

        const svg = d3.select(containerId)
            .append("svg")
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", `translate(${width / 2}, ${height / 2})`);

        const color = d3.scaleOrdinal()
            .domain(populationData.map(d => d.country))
            .range(["blue", "pink"]);

        const pie = d3.pie()
            .value(d => d.population);

        const arc = d3.arc()
            .innerRadius(0)
            .outerRadius(radius);

        // Tooltip setup
        const tooltip = d3.select(containerId).append("div")
            .style("position", "absolute")
            .style("visibility", "hidden")
            .style("background", "rgba(0, 0, 0, 0.7)")
            .style("color", "#fff")
            .style("padding", "5px 10px")
            .style("border-radius", "5px")
            .style("font-size", "12px");

        // Add arcs for the pie chart
        const arcs = svg.selectAll("arc")
            .data(pie(populationData))
            .enter()
            .append("g");

        arcs.append("path")
            .attr("d", arc)
            .attr("fill", d => color(d.data.country))
            .attr("stroke", "#fff")
            .style("stroke-width", "2px")
            .style("opacity", 0.8)
            .on("mouseover", (event, d) => {
                tooltip.style("visibility", "visible")
                    .text(`${d.data.country}: ${Math.round(d.data.population / 1e6)} M`)
                    .style("left", (event.pageX + 10) + "px")
                    .style("top", (event.pageY - 30) + "px");
            })
            .on("mousemove", (event) => {
                tooltip.style("left", (event.pageX + 10) + "px")
                    .style("top", (event.pageY - 30) + "px");
            })
            .on("mouseout", () => tooltip.style("visibility", "hidden"))
            .transition()
            .duration(1000)
            .attrTween("d", function (d) {
                const i = d3.interpolate({ startAngle: 0, endAngle: 0 }, d);
                return function (t) { return arc(i(t)); };
            });

        arcs.append("text")
            .attr("transform", d => `translate(${arc.centroid(d)})`)
            .attr("text-anchor", "middle")
            .style("font-size", "12px")
            .style("fill", "#fff")
            .html(d => {
                const percent = Math.round((d.data.population / d3.sum(populationData, d => d.population)) * 100);
                const popInMillions = Math.round(d.data.population / 1e6);
                return `${percent}%\n${popInMillions}M`;
            });

        // Display total population text
        const totalPopulation = d3.sum(populationData, d => d.population);
        svg.append("text")
            .attr("x", 0)
            .attr("y", radius + 20)
            .attr("text-anchor", "middle")
            .style("font-size", "14px")
            .style("fill", "#000")
            .style("font-weight", "bold")
            .text(`Total Population: ${Math.round(totalPopulation / 1e6)} M`);

        // Add legend
        const legend = svg.append("g")
            .attr("transform", `translate(-50, ${radius + 20})`);

        legend.selectAll("rect")
            .data(populationData)
            .enter().append("rect")
            .attr("x", 0)
            .attr("y", (d, i) => i * 20)
            .attr("width", 15)
            .attr("height", 15)
            .attr("fill", d => color(d.country));

        legend.selectAll("text")
            .data(populationData)
            .enter().append("text")
            .attr("x", 20)
            .attr("y", (d, i) => i * 20 + 12)
            .text(d => d.country)
            .style("font-size", "14px");
    });
}
        }
    </script>
    <script src="libs/bootstrap/bootstrap.bundle.min.js"></script>
    
    </div>
    <div id="chatgpt-usage-note">
        <h3>How I Used ChatGPT</h3>
        <p>
            I used ChatGPT for:<br><br>
            1. <strong>Generating D3.js Code</strong>: ChatGPT helped me by providing code examples for creating different types of charts (bar charts, line charts, pie charts) using D3.js. It also guided me through adding interactivity like tooltips to display values when hovering over elements, and creating dropdowns for year selection.<br><br>
            2. <strong>Adding UI Elements</strong>: ChatGPT assisted me in adding a link to ChatGPT on my dashboard. It offered multiple ways to position the link, including placing it beside the title or at the top-right corner of the page, with helpful CSS styling to ensure it looked clean and functional.<br><br>
            3. <strong>Customizing Layouts</strong>: ChatGPT gave me advice on improving the layout of my dashboard, including centering content, adjusting spacing, and making sure elements like the ChatGPT link were placed without additional containers.<br><br>
            4. <strong>Learning HTML/CSS and D3.js</strong>: ChatGPT helped me understand how to use flexbox, absolute positioning, and other CSS properties to arrange elements effectively and make the dashboard visually appealing and user-friendly.<br><br>
            This support has enabled me to develop a dynamic, interactive dashboard with well-organized content and additional features like the ChatGPT link.
        </p>
    </div>  
</body>
<a id="chatgpt-link" href="https://chatgpt.com/share/67ca4329-3264-8008-a01f-6a5ee6419a26" target="_blank">Go to ChatGPT</a>

    <!-- Main content area where your charts will be displayed -->
    <div id="main-content">
        <!-- Example content (replace with your actual charts or content) -->
        <svg width="250" height="200"></svg>


</html>
